16 — Nmap commands (active hosts, open ports, OS fingerprinting, ping scan, TCP scan)

Big warning (legal & ethical): Scanning networks you don't own or don't have explicit permission to scan can be illegal or violate policies. Only scan systems you control or have authorization to test.

Below are common nmap command lines and short explanations.

Ping scan (discover active hosts on a subnet)

-sn (previously -sP) disables port scan and only checks which hosts respond.

sudo nmap -sn 192.168.1.0/24


Output: lists hosts that responded to ICMP/ping/ARP/host discovery. On local networks, ARP-based discovery often finds most hosts even if ICMP is blocked.

List open ports on a single host (top ports / common)

Quick TCP SYN scan of common ports:

sudo nmap -sS -Pn -T4 --top-ports 100 10.0.0.5


-sS = TCP SYN (stealth) scan, -Pn skip host discovery (treat host as up), -T4 faster timing.

Full TCP port scan (all 65535 ports)

sudo nmap -sS -p- -T4 10.0.0.5


-p- = scan all ports 1–65535.

Service/version detection

sudo nmap -sV -p22,80,443 10.0.0.5


-sV probes services to report version strings.

OS fingerprinting

sudo nmap -O 10.0.0.5


-O attempts to identify the remote OS (requires root; accuracy varies).

Combine with -sV for richer output: sudo nmapversion detection, script scanning, traceroute).

TCP connect scan (no raw sockets required)

nmap -sT 10.0.0.5


Use when you don't have root and raw-socket SYN scan isn't available.

Ping sweep + port information for the whole subnet

sudo nmap -sS -p 22,80,443 --open 192.168.1.0/24


--open shows only hosts with at least one open port in the scanned set.

Quick host discovery using ARP on local networks (works even when ICMP blocked)

sudo nmap -sn 192.168.1.0/24


Nmap automatically uses ARP for local Ethernet if appropriate.

Aggressive scan (OS, version, scripts, traceroute)

sudo nmap -A -T4 10.0.0.5


Stealthy timing and evasion options (be careful)

-T0..-T5 timing templates; lower slows you down but can be stealthier.

--randomize-hosts randomizes order.

Using decoys, fragmentation, etc., may be suspicious and often unnecessary.